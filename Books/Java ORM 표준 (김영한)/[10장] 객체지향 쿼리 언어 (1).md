# [10장] 객체지향 쿼리 언어 (1)

##### - 10.1 객체지향 쿼리 소개 ◀︎ **현재 글**

##### - 10.2 JPQL(Java Persistence Query Language) ◀︎ **현재 글**

##### - 10.3 Criteria ◀︎ **현재 글**

##### - 10.4 QueryDsl ◀︎ **현재 글**

___

> JPA는 복잡한 검색 조건을 사용해서 엔티티 객체를 조회할 수 있는 다양한 쿼리 기술을 지원한다. JPQL은 가장 중요한 객체지향 쿼리 언어다. 

### | 10.1 객체지향 쿼리 소개 

> - 식별자로 조회 EntityManager.find()
> - 객체 그래프 탐색 
>
> 위 기능만으로는 애플리케이션 개발하기는 어렵다. 예를 들어, 나이가 30살 이상인 회원을 모두 검색하고 싶다면, 좀 더 현실적이고 복잡한 검색 방법이 필요하다. 그렇다고 <u>**모든 회원 엔티티를 메모리에 올려두고 애플리케이션에서 30살 이상인 회원을 검색하는 것은 현실성이 없다.**</u>
>
> 결국 데이터는 데이터베이스에 있으므로 <u>**SQL로 필요한 내용을 최대한 걸러서 조회**</u>해야 한다. ORM을 사용하면 데이터베이스 테이블이 아닌 엔티티 객체를 대상으로 개발하므로 검색도 테이블이 아닌 <u>엔티티 객체를 대상으로 하는 방법이 필요</u>하다. JPQL은 이런 문제를 해결하기 위해 만들어졌는데 다음과 같은 특성이 있다.
>
> - ###### 데이블이 아닌 <u>객체를 대상으로 검색</u>하는 객체지향 쿼리다.
>
> - ###### SQL을 추상화해서 특정 데이터베이스 SQL에 의존하지 않는다.
>
> SQL이 데이터베이스 테이블을 대상으로 하는 데이터 중심의 쿼리라면 <u>**JPQL은 엔티티 객체를 대상으로 하는 객체지향 쿼리**</u>다. JPQL을 사용하면 <u>JPA는 이 JPQL을 분석한 다음 적절한 SQL을 만들어 데이터베이스를 조회</u>한다. 그리고 조회한 결과로 엔티티 객체를 생성해서 반환한다. JPQL을 한마디로 정의하면 객체지향 SQL이다. 

### | 10.2 JPQL (Java Persistence Query Language)

> ###### - JPQL은 객체지향 쿼리 언어다. 따라서 테이블을 대상으로 쿼리하는 것이 아니라 <u>엔티티 객체를 대상으로 쿼리</u>한다.
>
> ###### - JPQL은 SQL을 추상화해서 특정 데이터베이스 SQL에 의존하지 않는다. 
>
> ###### - <u>JPQL은 결국 SQL로 변환된다.</u>

```java
@Entity(name="Member")
public class Member {
  @Column(name= "name")
  private String username;
}
```

```sql
select m from Member as m where m.username(필드명) = 'kim'

select member.id as id ... from Member member where member.name = 'kmi'

```

### | Criteria

> 문자로 작성한 JPQL보다 코드로 작성한 Criteria의 장점은 다음과 같다.
>
> ###### - 컴파일 시점에 오류를 발견할 수 있다.
>
> ###### - IDE를 사용하면 코드 자동완성을 지원한다.
>
> ###### - 동적 쿼리를 작성하기 편하다.

### | 10.4 QueryDSL 

> QueryDSL도 Criteria처럼 빌더 역할을 한다. QueryDSl의 장점은 **코드 기반**이면서 **단순하고 사용하기 쉽다**. 그리고 작성한 코드도 JPQL과 비슷해서 한눈에 들어온다. 상대적으로 QueryDSL에 비해서 Criteria는 너무 복잡하다. 
>
> 참고로 QueryDSL은 JPA 표준은 아니고 오픈소스 프로젝트다. 이것은 JPA뿐만 아니라 JDO, 몽고DB, Java Collection, Lucene, Hibernate Search도 거의 같은 문법으로 지원한다. 현재 스프링 데이터 프로젝트가 지원할 정도로 많이 기대되는 프로젝트다. 
